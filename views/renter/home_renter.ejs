<%- include('../header.ejs') -%>
<p style="display:none;" id ="user_local"><%=user%></p>
<p style="display:none;" id ="role_local"><%=role%></p>
<div>
  <h1><%= title %></h1>
  <p>Welcome to <%= title %></p>
  <br>



<!-- 
  <form method = "get" action = "/init">
    <button type = "submit">strart contract</button>
  </form>
  <br>
 -->

<br>




  <form method = "get" action = "/rooms/create">
    <button type = "submit">create room</button>
  </form>
  <br>
  <form method = "get" action = "/send_money">
    <button type = "submit">send money</button>
  </form>
  <br>
  <form method = "get" action = "/test_msg.data">
    <button type = "submit">test msg.data</button>
  </form>
  <br>
  <form method = "get" action = "/add_hash_to_db">
    <label for="hash_input">insert hash:</label>
    <input id = "hash_input" type="text" name="hash" >
    <button type = "submit">add hash to db</button>
  </form>
  <br>
  <form method="get" action="/balance" onsubmit="return isAddress(document.getElementById('account_input').value)">
    <label for="account_input"> Insert address:</label>
    <input id = "account_input" type="text" name="account" >
    <button id="search_balance" type="submit">search</button>
  </form>
  <br><br>
  <button onclick="print_globals()">check global vars</button>

</div>



<script>


  var {rentContract} = require("../web3_init");
  var globals = require("../global")
  
  function onloaded(){

        document.localStorage.setItem("user_global", document.getElementById("user_local").textContent);
        document.localStorage.setItem("role_global", document.getElementById("role_local").textContent)

      }

  function print_globals(){
    alert(document.getElementById("user_local").textContent)
    alert(document.localStorage.getItem("user_global"))
    alert(document.localStorage.getItem("role_global"))
  }
  function check_full(){
    fetch("https://localhost:3000/check_full")
    .then(data=>{
      return data.text()
    })
    .then(data=>{
      alert(data)
    })
  }

  function get_quantity(){
    fetch("https://localhost:3000/quantity")
    .then(data=>{
      return data.text()
    })
    .then(data=>{
      alert(data)
    })
  }

  function get_owner(){
    fetch("https://localhost:3000/owner")
    .then(data=>{
      return data.text()

    })
    .then(data=>{
      alert(data)
    })
  }
 
  
</script>

<script>
  if (document.readyState !== 'loading') {
    console.log('document is already ready, just execute code here');
    onloaded();
  }
  else {
      document.addEventListener('DOMContentLoaded', onloaded());
  } 
</script>

